{% trans_default_domain 'character' %}

<div class="container block py-3 mt-5" data-controller="character--avatar" data-character--avatar-id-value="{{ character.id }}">
  {{ include('character/show/header.html.twig') }}
  {{ include('character/show/menu.html.twig') }}
  <div class="row" data-controller="tabs" data-tabs-initial-value="general">
    <ul class="nav tabs row g-0 my-2">
      {% include "tab.html.twig" with {'name': 'general', 'domain': 'character'} only %}
      {% include "tab.html.twig" with {'name': 'merits', 'domain': 'character'} only %}
      {% if character.type != "human" %}
        {% include "tab.html.twig" with {'name': character.type, 'domain': 'character'} only %}
      {% endif %}
      {# {% include "tab.html.twig" with {'name': 'relations', 'domain': 'character'} only %} #}
      {% include "tab.html.twig" with {'name': 'background', 'domain': 'character'} only %}
      {% if app.user == character.player %}
        {% include "tab.html.twig" with {'name': 'notes', 'domain': 'character'} only %}
      {% endif %}
    </ul>
    <div id="general" data-tabs-target="page">
      <div class="row pb-3">
        <div class="col-12 col-md-6">
          {{ include('character/show/health.html.twig') }}
        </div>
        <div class="col-12 col-md-6">
          {{ include('character/show/willpower.html.twig') }}
        </div>
      </div>
      <div class="row pb-3">
        {% if character.type != "human" %}
          {{ include(character.type ~ '/show/trait.html.twig') }}
        {% endif %}
      </div>
      {{ include('character/show/advantages.html.twig') }}
      {{ include('character/show/attributes.html.twig') }}
      {{ include('character/show/skills.html.twig') }}
    </div>
    <div id="merits" data-tabs-target="page">
      {{ include('character/show/merits.html.twig') }}
    </div>
    {% if character.type != "human" %}
      <div id="{{ character.type }}" data-tabs-target="page">
        {{ include(character.type ~ '/show/powers.html.twig') }}
      </div>
    {% endif %}
    <div id="background" data-tabs-target="page">
      <div class="col-12 my-2 text-center">
        <img class="col-12 col-lg-6" src="{{ asset(character.id, 'characters') }}" onerror="this.src='{{ asset('default.jpg', 'characters') }}';this.onerror=null;">
          <div class="block mt-1">
            {% if character.background != "" %}
              {{ character.background|markdown_to_html }}
            {% else %}
              <p>{{ "background.none"|trans }}</p>
            {% endif %}
            <a href="{{ path('character_background', {'id': character.id}) }}">{{ "background.edit"|trans }}</a>
          </div>
      </div>
    </div>
    {% if app.user == character.player %}
      <div id="notes" data-tabs-target="page">
        <div class="col-12 my-2 text-center">
          {% if character.notes is not empty %}
            <a class="btn btn-primary" href="{{ path('character_notes_new', {'id': character.id}) }}">{% include "icon.html.twig" with {'icon' : 'add' } only %}</a>
            {% for note in character.notes %}
              <a class="btn btn-primary fs-sm" href="#note-{{ note.id }}">
                {{ note.assignedAt|format_datetime('short', 'none') }} - {{note.title|default('no title') }}
              </a>
            {% endfor %}
            <div class="row mt-5">
              {% for note in character.notes %}
                <div class="col-12 col-md-6">
                  <div id="note-{{ note.id }}" class="block">
                    <h3 class="pt-2">{{note.title|default('â€”') }}</h3>
                    <h5 class="text-end pe-2">{{ note.assignedAt|format_datetime('full', 'none') }}</h5>
                    <p>{{ note.content|markdown_to_html }}</p>
                    {% if note.author != character.player %}
                      <p class="text-end">{{ note.author }}</p>
                    {% endif %}
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <p>{{ "notes.none"|trans }}</p>
          {% endif %}
        </div>
      </div>
    {% endif %}
  </div>
</div>
